# Image Pull secret used to authenticate on the Docker registry
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-regcred
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{ template "imagePullSecret" . }}

# Mongo URI with embedded user & password
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secrets
type: Opaque
data:
  mongodb: {{ .Values.horizon.mongodb.uri | b64enc }}
  play: {{ randAscii 64 | nospace | b64enc }}
---
  {{- range .Values.horizon.vaults }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .name }}-vault-secret
type: Opaque
data:
  {{ if .password }}
  password: {{ .password | b64enc }}
  {{ else }}
  password: {{ randAscii 64 | nospace | b64enc }}
  {{ end }}
---
  {{- end }}
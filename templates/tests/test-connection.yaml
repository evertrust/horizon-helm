apiVersion: v1
kind: Pod
metadata:
  name: "{{ template "common.names.fullname" . }}-test-connection"
  labels: {{- include "horizon.labels.standard" . | nindent 4 }}
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: curl
      image: quay.io/curl/curl:latest
      command: ['curl']
      args: [
        '--fail',
        '--max-time', '5',
        '{{ template "common.names.fullname" . }}:9000/'
      ]
      livenessProbe:
        exec:
          command:
            - cat
            - /tmp/healthy
        initialDelaySeconds: 5
        periodSeconds: 5
  restartPolicy: Never